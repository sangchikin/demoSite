---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import CoursePreview from '../../components/CoursePreview.astro';

const allCourses = await getCollection('courses');
const sortedCourses = allCourses.sort((a, b) => 
    new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime()
);

const ITEMS_PER_PAGE = 6;
const paginatedCourses = sortedCourses.slice(0, ITEMS_PER_PAGE);

const title = 'Financial Courses';
const description = 'Learn financial management, investing, and wealth building through our comprehensive courses.';
---

<BaseLayout title={title} description={description}>
    <div class="max-w-3xl mx-auto py-12">
        <h1 class="font-serif text-4xl font-medium tracking-tight mb-2">{title}</h1>
        <p class="text-lg leading-normal opacity-75 mb-12">{description}</p>

        {paginatedCourses.length > 0 ? (
            <div class="space-y-8 mb-12">
                {paginatedCourses.map((course) => (
                    <CoursePreview course={course} headingLevel="h2" />
                ))}
            </div>
        ) : (
            <div class="text-center py-12">
                <p class="text-lg opacity-75">No courses available yet.</p>
            </div>
        )}

        {allCourses.length > ITEMS_PER_PAGE && (
            <div class="text-center">
                <a href="/courses/page/2" class="inline-block text-sm font-medium hover:opacity-75 transition">
                    View all courses â†’
                </a>
            </div>
        )}
    </div>
</BaseLayout>
